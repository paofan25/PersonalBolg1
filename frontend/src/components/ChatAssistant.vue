class WeatherService {\n  constructor() {\n    // ä½¿ç”¨æ­£ç¡®çš„API KEYå’ŒåŸŸå\n    this.key = '20ad4f9133c94ac69f48192ef755f473';\n    this.baseUrl = 'https://kv436fwcq8.re.qweatherapi.com/v7';\n    \n    // é»˜è®¤åŸå¸‚åˆ—è¡¨\n    this.defaultCities = [\n      { id: '101190101', name: 'å—äº¬' },\n      { id: '101020100', name: 'ä¸Šæµ·' },\n      { id: '101010100', name: 'åŒ—äº¬' }\n    ];\n\n    console.log('WeatherService initialized with custom domain');\n  }\n\n  // è·å–å½“å‰å¤©æ°”\n  async getNowWeather() {\n    try {\n      // ä½¿ç”¨é»˜è®¤åŸå¸‚ï¼ˆå—äº¬ï¼‰\n      const defaultCity = this.defaultCities[0];\n      console.log('ä½¿ç”¨é»˜è®¤åŸå¸‚:', defaultCity.name);\n\n      const url = `${this.baseUrl}/weather/now?location=${defaultCity.id}&key=${this.key}`;\n      console.log('è¯·æ±‚å¤©æ°”URL:', url);\n      \n      const weatherResponse = await fetch(url, {\n        headers: {\n          'Accept': 'application/json',\n          'Accept-Encoding': 'gzip'\n        }\n      });\n      \n      if (!weatherResponse.ok) {\n        throw new Error(`HTTP error! status: ${weatherResponse.status}`);\n      }\n      \n      const weatherData = await weatherResponse.json();\n      console.log('å¤©æ°”ä¿¡æ¯å“åº”:', weatherData);\n\n      if (weatherData.code === '200') {\n        const { temp, text, icon } = weatherData.now;\n        return {\n          temperature: temp,\n          condition: this.getWeatherCondition(icon),\n          description: text,\n          cityName: defaultCity.name,\n          updateTime: weatherData.updateTime\n        };\n      } else {\n        console.error('è·å–å¤©æ°”å¤±è´¥:', weatherData);\n        return this.getDefaultWeather();\n      }\n    } catch (error) {\n      console.error('è·å–å¤©æ°”å‡ºé”™:', error);\n      return this.getDefaultWeather();\n    }\n  }\n\n  // ç”Ÿæˆå¤©æ°”æè¿°\n  generateWeatherDescription(weather) {\n    const { temperature, description, cityName } = weather;\n    let suggestion = '';\n\n    // æ ¹æ®æ¸©åº¦ç»™å‡ºå»ºè®®\n    const temp = parseInt(temperature);\n    if (temp < 10) {\n      suggestion = 'å¤©æ°”æœ‰ç‚¹å†·ï¼Œè¦æ³¨æ„ä¿æš–å“¦~ ğŸ§¥';\n    } else if (temp > 30) {\n      suggestion = 'å¤©æ°”æœ‰ç‚¹çƒ­ï¼Œè®°å¾—é˜²æ™’è¡¥æ°´å“¦~ ğŸŒ';\n    } else {\n      suggestion = 'å¤©æ°”å¾ˆèˆ’é€‚ï¼Œé€‚åˆå‡ºé—¨æ´»åŠ¨å‘¢~ ğŸŒˆ';\n    }\n\n    // æ ¹æ®å¤©æ°”çŠ¶å†µæ·»åŠ ç‰¹å®šå»ºè®®\n    if (description.includes('é›¨')) {\n      suggestion += ' è®°å¾—å¸¦ä¼ï¼â˜”';\n    } else if (description.includes('æ™´')) {\n      suggestion += ' é˜²æ™’è¦åšå¥½ï¼ğŸ§´';\n    }\n\n    return `${cityName}ç°åœ¨æ°”æ¸©${temperature}Â°Cï¼Œ${description}ã€‚${suggestion}`;\n  }\n\n  // è·å–å¤©æ°”çŠ¶å†µ\n  getWeatherCondition(icon) {\n    const conditions = {\n      sunny: ['100', '101', '102', '103'],\n      cloudy: ['104', '150', '151', '152', '153'],\n      rainy: ['300', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '311', '312', '313', '314', '315', '316', '317', '318', '399'],\n      snowy: ['400', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '499'],\n      foggy: ['500', '501', '502', '503', '504', '507', '508', '509', '510', '511', '512', '513', '514', '515']\n    };\n\n    for (const [condition, icons] of Object.entries(conditions)) {\n      if (icons.includes(icon)) {\n        return condition;\n      }\n    }\n    return 'cloudy'; // é»˜è®¤è¿”å›å¤šäº‘\n  }\n\n  // è·å–é»˜è®¤å¤©æ°”æ•°æ®\n  getDefaultWeather() {\n    const defaultCity = this.defaultCities[0];\n    return {\n      temperature: 25,\n      condition: 'cloudy',\n      description: 'å¤šäº‘',\n      cityName: defaultCity.name,\n      updateTime: new Date().toISOString()\n    };\n  }\n\n  // åˆ‡æ¢åŸå¸‚\n  async switchCity(cityId) {\n    try {\n      const url = `${this.baseUrl}/weather/now?location=${cityId}&key=${this.key}`;\n      console.log('æ­£åœ¨è·å–å¤©æ°”ä¿¡æ¯...');\n      \n      const weatherResponse = await fetch(url, {\n        headers: {\n          'Accept': 'application/json',\n          'Accept-Encoding': 'gzip'\n        }\n      });\n      \n      if (!weatherResponse.ok) {\n        throw new Error(`HTTP error! status: ${weatherResponse.status}`);\n      }\n      \n      const weatherData = await weatherResponse.json();\n      console.log('åˆ‡æ¢åŸå¸‚å¤©æ°”å“åº”:', weatherData);\n\n      if (weatherData.code === '200') {\n        const { temp, text, icon } = weatherData.now;\n        const city = this.defaultCities.find(c => c.id === cityId) || { name: 'æœªçŸ¥åŸå¸‚' };\n        return {\n          temperature: temp,\n          condition: this.getWeatherCondition(icon),\n          description: text,\n          cityName: city.name,\n          updateTime: weatherData.updateTime\n        };\n      } else {\n        console.error('è·å–å¤©æ°”å¤±è´¥:', weatherData);\n        return this.getDefaultWeather();\n      }\n    } catch (error) {\n      console.error('åˆ‡æ¢åŸå¸‚å‡ºé”™:', error);\n      return this.getDefaultWeather();\n    }\n  }\n\n  // è§£æåŸå¸‚åç§°\n  parseCityName(text) {\n    for (const city of this.defaultCities) {\n      if (text.includes(city.name)) {\n        return city;\n      }\n    }\n    return null;\n  }\n}\n\nexport default new WeatherService();"
}