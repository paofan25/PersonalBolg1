{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nclass WeatherService {\n  constructor() {\n    // 使用开发者密钥\n    this.apiKey = '178baf6c846eaeb5ea632cdab055b9cd';\n    this.baseUrl = 'https://api.qweather.com/v7';\n\n    // 默认城市列表\n    this.defaultCities = [{\n      id: '101190101',\n      name: '南京'\n    }, {\n      id: '101020100',\n      name: '上海'\n    }, {\n      id: '101010100',\n      name: '北京'\n    }];\n    console.log('WeatherService initialized');\n  }\n\n  // 获取当前天气\n  async getNowWeather() {\n    try {\n      // 使用默认城市（南京）\n      const defaultCity = this.defaultCities[0];\n      console.log('使用默认城市:', defaultCity.name);\n      const weatherUrl = `${this.baseUrl}/weather/now?location=${defaultCity.id}&key=${this.apiKey}`;\n      console.log('正在获取天气信息...');\n      const weatherResponse = await fetch(weatherUrl);\n      const weatherText = await weatherResponse.text();\n      console.log('天气信息原始响应:', weatherText);\n      let weatherData;\n      try {\n        weatherData = JSON.parse(weatherText);\n      } catch (e) {\n        console.error('解析天气信息响应失败:', e);\n        return this.getDefaultWeather();\n      }\n      if (weatherData.code === '200') {\n        const {\n          temp,\n          text,\n          icon\n        } = weatherData.now;\n        return {\n          temperature: temp,\n          condition: this.getWeatherCondition(icon),\n          description: text,\n          cityName: defaultCity.name,\n          updateTime: weatherData.updateTime\n        };\n      } else {\n        console.error('获取天气失败:', weatherData);\n        return this.getDefaultWeather();\n      }\n    } catch (error) {\n      console.error('获取天气出错:', error);\n      return this.getDefaultWeather();\n    }\n  }\n\n  // 生成天气描述\n  generateWeatherDescription(weather) {\n    const {\n      temperature,\n      description,\n      cityName\n    } = weather;\n    let suggestion = '';\n\n    // 根据温度给出建议\n    const temp = parseInt(temperature);\n    if (temp < 10) {\n      suggestion = '天气有点冷，要注意保暖哦~ 🧥';\n    } else if (temp > 30) {\n      suggestion = '天气有点热，记得防晒补水哦~ 🌞';\n    } else {\n      suggestion = '天气很舒适，适合出门活动呢~ 🌈';\n    }\n\n    // 根据天气状况添加特定建议\n    if (description.includes('雨')) {\n      suggestion += ' 记得带伞！☔';\n    } else if (description.includes('晴')) {\n      suggestion += ' 防晒要做好！🧴';\n    }\n    return `${cityName}现在气温${temperature}°C，${description}。${suggestion}`;\n  }\n\n  // 获取天气状况\n  getWeatherCondition(icon) {\n    const conditions = {\n      sunny: ['100', '101', '102', '103'],\n      cloudy: ['104', '150', '151', '152', '153'],\n      rainy: ['300', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '311', '312', '313', '314', '315', '316', '317', '318', '399'],\n      snowy: ['400', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '499'],\n      foggy: ['500', '501', '502', '503', '504', '507', '508', '509', '510', '511', '512', '513', '514', '515']\n    };\n    for (const [condition, icons] of Object.entries(conditions)) {\n      if (icons.includes(icon)) {\n        return condition;\n      }\n    }\n    return 'cloudy'; // 默认返回多云\n  }\n\n  // 获取默认天气数据\n  getDefaultWeather() {\n    const defaultCity = this.defaultCities[0];\n    return {\n      temperature: 25,\n      condition: 'cloudy',\n      description: '多云',\n      cityName: defaultCity.name,\n      updateTime: new Date().toISOString()\n    };\n  }\n\n  // 切换城市\n  async switchCity(cityId) {\n    try {\n      const weatherUrl = `${this.baseUrl}/weather/now?location=${cityId}&key=${this.apiKey}`;\n      console.log('正在获取天气信息...');\n      const weatherResponse = await fetch(weatherUrl);\n      const weatherData = await weatherResponse.json();\n      if (weatherData.code === '200') {\n        const {\n          temp,\n          text,\n          icon\n        } = weatherData.now;\n        const city = this.defaultCities.find(c => c.id === cityId) || {\n          name: '未知城市'\n        };\n        return {\n          temperature: temp,\n          condition: this.getWeatherCondition(icon),\n          description: text,\n          cityName: city.name,\n          updateTime: weatherData.updateTime\n        };\n      } else {\n        console.error('获取天气失败:', weatherData);\n        return this.getDefaultWeather();\n      }\n    } catch (error) {\n      console.error('切换城市出错:', error);\n      return this.getDefaultWeather();\n    }\n  }\n}\nexport default new WeatherService();","map":{"version":3,"names":["WeatherService","constructor","apiKey","baseUrl","defaultCities","id","name","console","log","getNowWeather","defaultCity","weatherUrl","weatherResponse","fetch","weatherText","text","weatherData","JSON","parse","e","error","getDefaultWeather","code","temp","icon","now","temperature","condition","getWeatherCondition","description","cityName","updateTime","generateWeatherDescription","weather","suggestion","parseInt","includes","conditions","sunny","cloudy","rainy","snowy","foggy","icons","Object","entries","Date","toISOString","switchCity","cityId","json","city","find","c"],"sources":["E:/code/PersonalBolg1/frontend/src/services/weather.js"],"sourcesContent":["class WeatherService {\n  constructor() {\n    // 使用开发者密钥\n    this.apiKey = '178baf6c846eaeb5ea632cdab055b9cd';\n    this.baseUrl = 'https://api.qweather.com/v7';\n    \n    // 默认城市列表\n    this.defaultCities = [\n      { id: '101190101', name: '南京' },\n      { id: '101020100', name: '上海' },\n      { id: '101010100', name: '北京' }\n    ];\n\n    console.log('WeatherService initialized');\n  }\n\n  // 获取当前天气\n  async getNowWeather() {\n    try {\n      // 使用默认城市（南京）\n      const defaultCity = this.defaultCities[0];\n      console.log('使用默认城市:', defaultCity.name);\n\n      const weatherUrl = `${this.baseUrl}/weather/now?location=${defaultCity.id}&key=${this.apiKey}`;\n      console.log('正在获取天气信息...');\n      \n      const weatherResponse = await fetch(weatherUrl);\n      const weatherText = await weatherResponse.text();\n      console.log('天气信息原始响应:', weatherText);\n      \n      let weatherData;\n      try {\n        weatherData = JSON.parse(weatherText);\n      } catch (e) {\n        console.error('解析天气信息响应失败:', e);\n        return this.getDefaultWeather();\n      }\n\n      if (weatherData.code === '200') {\n        const { temp, text, icon } = weatherData.now;\n        return {\n          temperature: temp,\n          condition: this.getWeatherCondition(icon),\n          description: text,\n          cityName: defaultCity.name,\n          updateTime: weatherData.updateTime\n        };\n      } else {\n        console.error('获取天气失败:', weatherData);\n        return this.getDefaultWeather();\n      }\n    } catch (error) {\n      console.error('获取天气出错:', error);\n      return this.getDefaultWeather();\n    }\n  }\n\n  // 生成天气描述\n  generateWeatherDescription(weather) {\n    const { temperature, description, cityName } = weather;\n    let suggestion = '';\n\n    // 根据温度给出建议\n    const temp = parseInt(temperature);\n    if (temp < 10) {\n      suggestion = '天气有点冷，要注意保暖哦~ 🧥';\n    } else if (temp > 30) {\n      suggestion = '天气有点热，记得防晒补水哦~ 🌞';\n    } else {\n      suggestion = '天气很舒适，适合出门活动呢~ 🌈';\n    }\n\n    // 根据天气状况添加特定建议\n    if (description.includes('雨')) {\n      suggestion += ' 记得带伞！☔';\n    } else if (description.includes('晴')) {\n      suggestion += ' 防晒要做好！🧴';\n    }\n\n    return `${cityName}现在气温${temperature}°C，${description}。${suggestion}`;\n  }\n\n  // 获取天气状况\n  getWeatherCondition(icon) {\n    const conditions = {\n      sunny: ['100', '101', '102', '103'],\n      cloudy: ['104', '150', '151', '152', '153'],\n      rainy: ['300', '301', '302', '303', '304', '305', '306', '307', '308', '309', '310', '311', '312', '313', '314', '315', '316', '317', '318', '399'],\n      snowy: ['400', '401', '402', '403', '404', '405', '406', '407', '408', '409', '410', '499'],\n      foggy: ['500', '501', '502', '503', '504', '507', '508', '509', '510', '511', '512', '513', '514', '515']\n    };\n\n    for (const [condition, icons] of Object.entries(conditions)) {\n      if (icons.includes(icon)) {\n        return condition;\n      }\n    }\n    return 'cloudy'; // 默认返回多云\n  }\n\n  // 获取默认天气数据\n  getDefaultWeather() {\n    const defaultCity = this.defaultCities[0];\n    return {\n      temperature: 25,\n      condition: 'cloudy',\n      description: '多云',\n      cityName: defaultCity.name,\n      updateTime: new Date().toISOString()\n    };\n  }\n\n  // 切换城市\n  async switchCity(cityId) {\n    try {\n      const weatherUrl = `${this.baseUrl}/weather/now?location=${cityId}&key=${this.apiKey}`;\n      console.log('正在获取天气信息...');\n      \n      const weatherResponse = await fetch(weatherUrl);\n      const weatherData = await weatherResponse.json();\n\n      if (weatherData.code === '200') {\n        const { temp, text, icon } = weatherData.now;\n        const city = this.defaultCities.find(c => c.id === cityId) || { name: '未知城市' };\n        return {\n          temperature: temp,\n          condition: this.getWeatherCondition(icon),\n          description: text,\n          cityName: city.name,\n          updateTime: weatherData.updateTime\n        };\n      } else {\n        console.error('获取天气失败:', weatherData);\n        return this.getDefaultWeather();\n      }\n    } catch (error) {\n      console.error('切换城市出错:', error);\n      return this.getDefaultWeather();\n    }\n  }\n}\n\nexport default new WeatherService();"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}