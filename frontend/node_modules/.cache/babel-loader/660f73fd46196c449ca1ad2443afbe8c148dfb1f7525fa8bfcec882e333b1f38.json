{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRouter } from 'vue-router';\nimport { Message, Lock } from '@element-plus/icons-vue';\nimport { ElMessage } from 'element-plus';\nexport default {\n  name: 'LoginView',\n  components: {\n    Message,\n    Lock\n  },\n  setup() {\n    const store = useStore();\n    const router = useRouter();\n    const formRef = ref(null);\n    const isLoading = ref(false);\n    const loginForm = ref({\n      email: '',\n      password: ''\n    });\n    const rules = {\n      email: [{\n        required: true,\n        message: '请输入邮箱',\n        trigger: 'blur'\n      }, {\n        type: 'email',\n        message: '请输入正确的邮箱格式',\n        trigger: 'blur'\n      }],\n      password: [{\n        required: true,\n        message: '请输入密码',\n        trigger: 'blur'\n      }, {\n        min: 6,\n        message: '密码至少6个字符',\n        trigger: 'blur'\n      }]\n    };\n    const handleLogin = async () => {\n      if (!formRef.value) return;\n      await formRef.value.validate(async valid => {\n        if (valid) {\n          try {\n            isLoading.value = true;\n            const result = await store.dispatch('auth/login', loginForm.value);\n            ElMessage({\n              type: 'success',\n              message: '登录成功！'\n            });\n            if (result && result.redirectTo) {\n              router.push(result.redirectTo);\n            } else {\n              router.push('/');\n            }\n            if (result && result.infoError) {\n              ElMessage({\n                type: 'warning',\n                message: `用户信息获取不完整: ${result.infoError}，部分功能可能受限`\n              });\n            }\n          } catch (error) {\n            ElMessage({\n              type: 'error',\n              message: error.message || '登录失败，请重试'\n            });\n          } finally {\n            isLoading.value = false;\n          }\n        }\n      });\n    };\n    return {\n      formRef,\n      loginForm,\n      isLoading,\n      rules,\n      handleLogin\n    };\n  }\n};","map":{"version":3,"names":["ref","useStore","useRouter","Message","Lock","ElMessage","name","components","setup","store","router","formRef","isLoading","loginForm","email","password","rules","required","message","trigger","type","min","handleLogin","value","validate","valid","result","dispatch","redirectTo","push","infoError","error"],"sources":["E:\\code\\PersonalBolg1\\frontend\\src\\views\\LoginView.vue"],"sourcesContent":["<template>\n  <div class=\"login-container\">\n    <el-card class=\"login-card\">\n      <template #header>\n        <h2 class=\"login-title\">登录</h2>\n      </template>\n      \n      <el-form \n        ref=\"formRef\"\n        :model=\"loginForm\"\n        :rules=\"rules\"\n        label-position=\"top\"\n        @submit.prevent=\"handleLogin\"\n      >\n        <el-form-item label=\"邮箱\" prop=\"email\">\n          <el-input \n            v-model=\"loginForm.email\"\n            placeholder=\"请输入邮箱\"\n          >\n            <template #prefix>\n              <el-icon><Message /></el-icon>\n            </template>\n          </el-input>\n        </el-form-item>\n        \n        <el-form-item label=\"密码\" prop=\"password\">\n          <el-input \n            v-model=\"loginForm.password\"\n            type=\"password\" \n            placeholder=\"请输入密码\"\n            show-password\n          >\n            <template #prefix>\n              <el-icon><Lock /></el-icon>\n            </template>\n          </el-input>\n        </el-form-item>\n        \n        <el-form-item>\n          <el-button \n            type=\"primary\" \n            native-type=\"submit\"\n            :loading=\"isLoading\"\n            class=\"login-button\"\n          >\n            登录\n          </el-button>\n        </el-form-item>\n      </el-form>\n      \n      <div class=\"login-links\">\n        <router-link to=\"/forgot-password\">忘记密码？</router-link>\n        <router-link to=\"/register\">注册新账号</router-link>\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport { ref } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRouter } from 'vue-router'\nimport { Message, Lock } from '@element-plus/icons-vue'\nimport { ElMessage } from 'element-plus'\n\nexport default {\n  name: 'LoginView',\n  components: {\n    Message,\n    Lock\n  },\n  setup() {\n    const store = useStore()\n    const router = useRouter()\n    const formRef = ref(null)\n    const isLoading = ref(false)\n    \n    const loginForm = ref({\n      email: '',\n      password: ''\n    })\n    \n    const rules = {\n      email: [\n        { required: true, message: '请输入邮箱', trigger: 'blur' },\n        { type: 'email', message: '请输入正确的邮箱格式', trigger: 'blur' }\n      ],\n      password: [\n        { required: true, message: '请输入密码', trigger: 'blur' },\n        { min: 6, message: '密码至少6个字符', trigger: 'blur' }\n      ]\n    }\n    \n    const handleLogin = async () => {\n      if (!formRef.value) return\n      \n      await formRef.value.validate(async (valid) => {\n        if (valid) {\n          try {\n            isLoading.value = true\n            const result = await store.dispatch('auth/login', loginForm.value)\n            ElMessage({\n              type: 'success',\n              message: '登录成功！'\n            })\n\n            if (result && result.redirectTo) {\n              router.push(result.redirectTo)\n            } else {\n              router.push('/')\n            }\n            \n            if (result && result.infoError) {\n              ElMessage({\n                type: 'warning',\n                message: `用户信息获取不完整: ${result.infoError}，部分功能可能受限`\n              })\n            }\n          } catch (error) {\n            ElMessage({\n              type: 'error',\n              message: error.message || '登录失败，请重试'\n            })\n          } finally {\n            isLoading.value = false\n          }\n        }\n      })\n    }\n    \n    return {\n      formRef,\n      loginForm,\n      isLoading,\n      rules,\n      handleLogin\n    }\n  }\n}\n</script>\n\n<style scoped>\n.login-container {\n  min-height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: var(--background-color);\n}\n\n.login-card {\n  width: 100%;\n  max-width: 400px;\n  margin: 20px;\n}\n\n.login-title {\n  text-align: center;\n  color: var(--text-color);\n  margin: 0;\n}\n\n.login-button {\n  width: 100%;\n}\n\n.login-links {\n  margin-top: 20px;\n  display: flex;\n  justify-content: space-between;\n  font-size: 14px;\n}\n\n.login-links a {\n  color: var(--primary-color);\n  text-decoration: none;\n}\n\n.login-links a:hover {\n  text-decoration: underline;\n}\n\n:deep(.el-input__prefix) {\n  display: flex;\n  align-items: center;\n}\n</style>"],"mappings":";AA2DA,SAASA,GAAE,QAAS,KAAI;AACxB,SAASC,QAAO,QAAS,MAAK;AAC9B,SAASC,SAAQ,QAAS,YAAW;AACrC,SAASC,OAAO,EAAEC,IAAG,QAAS,yBAAwB;AACtD,SAASC,SAAQ,QAAS,cAAa;AAEvC,eAAe;EACbC,IAAI,EAAE,WAAW;EACjBC,UAAU,EAAE;IACVJ,OAAO;IACPC;EACF,CAAC;EACDI,KAAKA,CAAA,EAAG;IACN,MAAMC,KAAI,GAAIR,QAAQ,CAAC;IACvB,MAAMS,MAAK,GAAIR,SAAS,CAAC;IACzB,MAAMS,OAAM,GAAIX,GAAG,CAAC,IAAI;IACxB,MAAMY,SAAQ,GAAIZ,GAAG,CAAC,KAAK;IAE3B,MAAMa,SAAQ,GAAIb,GAAG,CAAC;MACpBc,KAAK,EAAE,EAAE;MACTC,QAAQ,EAAE;IACZ,CAAC;IAED,MAAMC,KAAI,GAAI;MACZF,KAAK,EAAE,CACL;QAAEG,QAAQ,EAAE,IAAI;QAAEC,OAAO,EAAE,OAAO;QAAEC,OAAO,EAAE;MAAO,CAAC,EACrD;QAAEC,IAAI,EAAE,OAAO;QAAEF,OAAO,EAAE,YAAY;QAAEC,OAAO,EAAE;MAAO,EACzD;MACDJ,QAAQ,EAAE,CACR;QAAEE,QAAQ,EAAE,IAAI;QAAEC,OAAO,EAAE,OAAO;QAAEC,OAAO,EAAE;MAAO,CAAC,EACrD;QAAEE,GAAG,EAAE,CAAC;QAAEH,OAAO,EAAE,UAAU;QAAEC,OAAO,EAAE;MAAO;IAEnD;IAEA,MAAMG,WAAU,GAAI,MAAAA,CAAA,KAAY;MAC9B,IAAI,CAACX,OAAO,CAACY,KAAK,EAAE;MAEpB,MAAMZ,OAAO,CAACY,KAAK,CAACC,QAAQ,CAAC,MAAOC,KAAK,IAAK;QAC5C,IAAIA,KAAK,EAAE;UACT,IAAI;YACFb,SAAS,CAACW,KAAI,GAAI,IAAG;YACrB,MAAMG,MAAK,GAAI,MAAMjB,KAAK,CAACkB,QAAQ,CAAC,YAAY,EAAEd,SAAS,CAACU,KAAK;YACjElB,SAAS,CAAC;cACRe,IAAI,EAAE,SAAS;cACfF,OAAO,EAAE;YACX,CAAC;YAED,IAAIQ,MAAK,IAAKA,MAAM,CAACE,UAAU,EAAE;cAC/BlB,MAAM,CAACmB,IAAI,CAACH,MAAM,CAACE,UAAU;YAC/B,OAAO;cACLlB,MAAM,CAACmB,IAAI,CAAC,GAAG;YACjB;YAEA,IAAIH,MAAK,IAAKA,MAAM,CAACI,SAAS,EAAE;cAC9BzB,SAAS,CAAC;gBACRe,IAAI,EAAE,SAAS;gBACfF,OAAO,EAAE,cAAcQ,MAAM,CAACI,SAAS;cACzC,CAAC;YACH;UACF,EAAE,OAAOC,KAAK,EAAE;YACd1B,SAAS,CAAC;cACRe,IAAI,EAAE,OAAO;cACbF,OAAO,EAAEa,KAAK,CAACb,OAAM,IAAK;YAC5B,CAAC;UACH,UAAU;YACRN,SAAS,CAACW,KAAI,GAAI,KAAI;UACxB;QACF;MACF,CAAC;IACH;IAEA,OAAO;MACLZ,OAAO;MACPE,SAAS;MACTD,SAAS;MACTI,KAAK;MACLM;IACF;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}