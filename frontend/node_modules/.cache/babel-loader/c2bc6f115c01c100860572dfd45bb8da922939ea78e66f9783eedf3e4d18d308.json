{"ast":null,"code":"import { toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, normalizeStyle as _normalizeStyle, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"user-info\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"username\"\n};\nconst _hoisted_3 = {\n  class: \"dropdown-user-info\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_avatar = _resolveComponent(\"el-avatar\");\n  const _component_arrow_down = _resolveComponent(\"arrow-down\");\n  const _component_el_icon = _resolveComponent(\"el-icon\");\n  const _component_User = _resolveComponent(\"User\");\n  const _component_el_dropdown_item = _resolveComponent(\"el-dropdown-item\");\n  const _component_Setting = _resolveComponent(\"Setting\");\n  const _component_SwitchButton = _resolveComponent(\"SwitchButton\");\n  const _component_el_dropdown_menu = _resolveComponent(\"el-dropdown-menu\");\n  const _component_el_dropdown = _resolveComponent(\"el-dropdown\");\n  return _openBlock(), _createBlock(_component_el_dropdown, {\n    class: \"user-dropdown\",\n    trigger: \"click\"\n  }, {\n    dropdown: _withCtx(() => [_createVNode(_component_el_dropdown_menu, null, {\n      default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"strong\", null, _toDisplayString($setup.username), 1 /* TEXT */), _createElementVNode(\"small\", null, _toDisplayString($setup.userEmail), 1 /* TEXT */)]), _createVNode(_component_el_dropdown_item, {\n        onClick: $setup.goToProfile\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_icon, null, {\n          default: _withCtx(() => [_createVNode(_component_User)]),\n          _: 1 /* STABLE */\n        }), _cache[0] || (_cache[0] = _createTextVNode(\" 个人中心 \"))]),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"onClick\"]), _createVNode(_component_el_dropdown_item, {\n        onClick: $setup.goToSettings\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_icon, null, {\n          default: _withCtx(() => [_createVNode(_component_Setting)]),\n          _: 1 /* STABLE */\n        }), _cache[1] || (_cache[1] = _createTextVNode(\" 设置 \"))]),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"onClick\"]), _createVNode(_component_el_dropdown_item, {\n        divided: \"\",\n        onClick: $setup.handleLogout\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_icon, null, {\n          default: _withCtx(() => [_createVNode(_component_SwitchButton)]),\n          _: 1 /* STABLE */\n        }), _cache[2] || (_cache[2] = _createTextVNode(\" 退出登录 \"))]),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"onClick\"])]),\n      _: 1 /* STABLE */\n    })]),\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_createVNode(_component_el_avatar, {\n      size: 40,\n      src: $setup.userAvatar,\n      style: _normalizeStyle({\n        backgroundColor: $setup.avatarColor\n      })\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString($setup.userInitial), 1 /* TEXT */)]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"src\", \"style\"]), $setup.shouldShowUsername ? (_openBlock(), _createElementBlock(\"span\", _hoisted_2, _toDisplayString($setup.username), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _createVNode(_component_el_icon, {\n      class: \"el-icon--right\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_arrow_down)]),\n      _: 1 /* STABLE */\n    })])]),\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["class","key","_createBlock","_component_el_dropdown","trigger","dropdown","_withCtx","_createVNode","_component_el_dropdown_menu","default","_createElementVNode","_hoisted_3","_toDisplayString","$setup","username","userEmail","_component_el_dropdown_item","onClick","goToProfile","_component_el_icon","_component_User","_","_createTextVNode","goToSettings","_component_Setting","divided","handleLogout","_component_SwitchButton","_hoisted_1","_component_el_avatar","size","src","userAvatar","style","_normalizeStyle","backgroundColor","avatarColor","userInitial","shouldShowUsername","_createElementBlock","_hoisted_2","_createCommentVNode","_component_arrow_down"],"sources":["E:\\code\\PersonalBolg1\\frontend\\src\\components\\UserDropdown.vue"],"sourcesContent":["<template>\r\n  <el-dropdown class=\"user-dropdown\" trigger=\"click\">\r\n    <div class=\"user-info\">\r\n      <el-avatar \r\n        :size=\"40\" \r\n        :src=\"userAvatar\" \r\n        :style=\"{ backgroundColor: avatarColor }\"\r\n      >\r\n        {{ userInitial }}\r\n      </el-avatar>\r\n      <span v-if=\"shouldShowUsername\" class=\"username\">{{ username }}</span>\r\n      <el-icon class=\"el-icon--right\"><arrow-down /></el-icon>\r\n    </div>\r\n    \r\n    <template #dropdown>\r\n      <el-dropdown-menu>\r\n        <div class=\"dropdown-user-info\">\r\n          <strong>{{ username }}</strong>\r\n          <small>{{ userEmail }}</small>\r\n        </div>\r\n        <el-dropdown-item @click=\"goToProfile\">\r\n          <el-icon><User /></el-icon>\r\n          个人中心\r\n        </el-dropdown-item>\r\n        <el-dropdown-item @click=\"goToSettings\">\r\n          <el-icon><Setting /></el-icon>\r\n          设置\r\n        </el-dropdown-item>\r\n        <el-dropdown-item divided @click=\"handleLogout\">\r\n          <el-icon><SwitchButton /></el-icon>\r\n          退出登录\r\n        </el-dropdown-item>\r\n      </el-dropdown-menu>\r\n    </template>\r\n  </el-dropdown>\r\n</template>\r\n\r\n<script>\r\nimport { computed, ref } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { useRouter } from 'vue-router'\r\nimport { User, Setting, SwitchButton, ArrowDown } from '@element-plus/icons-vue'\r\nimport { ElMessage } from 'element-plus'\r\n\r\nexport default {\r\n  name: 'UserDropdown',\r\n  components: {\r\n    User,\r\n    Setting,\r\n    SwitchButton,\r\n    ArrowDown\r\n  },\r\n  props: {\r\n    showUsername: {\r\n      type: Boolean,\r\n      default: true\r\n    }\r\n  },\r\n  setup(props) {\r\n    const store = useStore()\r\n    const router = useRouter()\r\n    \r\n    // 生成随机颜色\r\n    const getRandomColor = () => {\r\n      const hue = Math.floor(Math.random() * 360)\r\n      return `hsl(${hue}, 70%, 75%)`\r\n    }\r\n    \r\n    const avatarColor = ref(getRandomColor())\r\n\r\n    // 用户信息\r\n    const username = computed(() => store.state.auth.user?.username || '用户')\r\n    const userEmail = computed(() => store.state.auth.user?.email || '')\r\n    const userAvatar = computed(() => store.state.auth.user?.avatar || '')\r\n    const userInitial = computed(() => username.value.charAt(0).toUpperCase())\r\n    \r\n    // 显示用户名（根据props控制）\r\n    const shouldShowUsername = computed(() => props.showUsername)\r\n\r\n    // 导航方法\r\n    const goToProfile = () => {\r\n      router.push('/profile')\r\n    }\r\n\r\n    const goToSettings = () => {\r\n      router.push('/settings')\r\n    }\r\n\r\n    // 退出登录\r\n    const handleLogout = async () => {\r\n      try {\r\n        await store.dispatch('auth/logout')\r\n        ElMessage({\r\n          type: 'success',\r\n          message: '已成功退出登录'\r\n        })\r\n        router.push('/login')\r\n      } catch (error) {\r\n        console.error('退出登录失败:', error)\r\n        ElMessage({\r\n          type: 'error',\r\n          message: '退出登录失败，请重试'\r\n        })\r\n      }\r\n    }\r\n\r\n    return {\r\n      username,\r\n      userEmail,\r\n      userAvatar,\r\n      userInitial,\r\n      avatarColor,\r\n      shouldShowUsername,\r\n      goToProfile,\r\n      goToSettings,\r\n      handleLogout\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.user-dropdown {\r\n  cursor: pointer;\r\n}\r\n\r\n.user-info {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  padding: 4px 8px;\r\n  border-radius: 20px;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\n.user-info:hover {\r\n  background-color: rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.username {\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  color: var(--text-color);\r\n  max-width: 120px;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n}\r\n\r\n.dropdown-user-info {\r\n  padding: 10px 16px;\r\n  border-bottom: 1px solid var(--border-color-light);\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 4px;\r\n}\r\n\r\n.dropdown-user-info strong {\r\n  font-size: 14px;\r\n  color: var(--text-color-dark);\r\n}\r\n\r\n.dropdown-user-info small {\r\n  font-size: 12px;\r\n  color: var(--text-color-light);\r\n}\r\n\r\n:deep(.el-dropdown-menu__item) {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  padding: 10px 16px;\r\n}\r\n\r\n:deep(.el-icon) {\r\n  margin-right: 4px;\r\n}\r\n</style> "],"mappings":";;EAESA,KAAK,EAAC;AAAW;;EAF1BC,GAAA;EAUsCD,KAAK,EAAC;;;EAM/BA,KAAK,EAAC;AAAoB;;;;;;;;;;;uBAfrCE,YAAA,CAiCcC,sBAAA;IAjCDH,KAAK,EAAC,eAAe;IAACI,OAAO,EAAC;;IAa9BC,QAAQ,EAAAC,QAAA,CACjB,MAiBmB,CAjBnBC,YAAA,CAiBmBC,2BAAA;MAhCzBC,OAAA,EAAAH,QAAA,CAgBQ,MAGM,CAHNI,mBAAA,CAGM,OAHNC,UAGM,GAFJD,mBAAA,CAA+B,gBAAAE,gBAAA,CAApBC,MAAA,CAAAC,QAAQ,kBACnBJ,mBAAA,CAA8B,eAAAE,gBAAA,CAApBC,MAAA,CAAAE,SAAS,iB,GAErBR,YAAA,CAGmBS,2BAAA;QAHAC,OAAK,EAAEJ,MAAA,CAAAK;MAAW;QApB7CT,OAAA,EAAAH,QAAA,CAqBU,MAA2B,CAA3BC,YAAA,CAA2BY,kBAAA;UArBrCV,OAAA,EAAAH,QAAA,CAqBmB,MAAQ,CAARC,YAAA,CAAQa,eAAA,E;UArB3BC,CAAA;sCAAAC,gBAAA,CAqBqC,QAE7B,G;QAvBRD,CAAA;sCAwBQd,YAAA,CAGmBS,2BAAA;QAHAC,OAAK,EAAEJ,MAAA,CAAAU;MAAY;QAxB9Cd,OAAA,EAAAH,QAAA,CAyBU,MAA8B,CAA9BC,YAAA,CAA8BY,kBAAA;UAzBxCV,OAAA,EAAAH,QAAA,CAyBmB,MAAW,CAAXC,YAAA,CAAWiB,kBAAA,E;UAzB9BH,CAAA;sCAAAC,gBAAA,CAyBwC,MAEhC,G;QA3BRD,CAAA;sCA4BQd,YAAA,CAGmBS,2BAAA;QAHDS,OAAO,EAAP,EAAO;QAAER,OAAK,EAAEJ,MAAA,CAAAa;;QA5B1CjB,OAAA,EAAAH,QAAA,CA6BU,MAAmC,CAAnCC,YAAA,CAAmCY,kBAAA;UA7B7CV,OAAA,EAAAH,QAAA,CA6BmB,MAAgB,CAAhBC,YAAA,CAAgBoB,uBAAA,E;UA7BnCN,CAAA;sCAAAC,gBAAA,CA6B6C,QAErC,G;QA/BRD,CAAA;;MAAAA,CAAA;;IAAAZ,OAAA,EAAAH,QAAA,CAEI,MAUM,CAVNI,mBAAA,CAUM,OAVNkB,UAUM,GATJrB,YAAA,CAMYsB,oBAAA;MALTC,IAAI,EAAE,EAAE;MACRC,GAAG,EAAElB,MAAA,CAAAmB,UAAU;MACfC,KAAK,EANdC,eAAA;QAAAC,eAAA,EAMmCtB,MAAA,CAAAuB;MAAW;;MAN9C3B,OAAA,EAAAH,QAAA,CAQQ,MAAiB,CARzBgB,gBAAA,CAAAV,gBAAA,CAQWC,MAAA,CAAAwB,WAAW,iB;MARtBhB,CAAA;yCAUkBR,MAAA,CAAAyB,kBAAkB,I,cAA9BC,mBAAA,CAAsE,QAAtEC,UAAsE,EAAA5B,gBAAA,CAAlBC,MAAA,CAAAC,QAAQ,oBAVlE2B,mBAAA,gBAWMlC,YAAA,CAAwDY,kBAAA;MAA/CnB,KAAK,EAAC;IAAgB;MAXrCS,OAAA,EAAAH,QAAA,CAWsC,MAAc,CAAdC,YAAA,CAAcmC,qBAAA,E;MAXpDrB,CAAA;;IAAAA,CAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}