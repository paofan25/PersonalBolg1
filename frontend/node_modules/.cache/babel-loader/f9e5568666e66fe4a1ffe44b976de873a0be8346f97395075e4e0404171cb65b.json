{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { computed, ref } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRouter } from 'vue-router';\nimport { User, Setting, SwitchButton, ArrowDown } from '@element-plus/icons-vue';\nimport { ElMessage } from 'element-plus';\nexport default {\n  name: 'UserDropdown',\n  components: {\n    User,\n    Setting,\n    SwitchButton,\n    ArrowDown\n  },\n  props: {\n    showUsername: {\n      type: Boolean,\n      default: true\n    }\n  },\n  setup(props) {\n    const store = useStore();\n    const router = useRouter();\n\n    // 生成随机颜色\n    const getRandomColor = () => {\n      const hue = Math.floor(Math.random() * 360);\n      return `hsl(${hue}, 70%, 75%)`;\n    };\n    const avatarColor = ref(getRandomColor());\n\n    // 用户信息\n    const username = computed(() => store.state.auth.user?.username || '用户');\n    const userEmail = computed(() => store.state.auth.user?.email || '');\n    const userAvatar = computed(() => store.state.auth.user?.avatar || '');\n    const userInitial = computed(() => username.value.charAt(0).toUpperCase());\n\n    // 显示用户名（根据props控制）\n    const shouldShowUsername = computed(() => props.showUsername);\n\n    // 导航方法\n    const goToProfile = () => {\n      router.push('/profile');\n    };\n    const goToSettings = () => {\n      router.push('/settings');\n    };\n\n    // 退出登录\n    const handleLogout = async () => {\n      try {\n        await store.dispatch('auth/logout');\n        ElMessage({\n          type: 'success',\n          message: '已成功退出登录'\n        });\n        router.push('/login');\n      } catch (error) {\n        console.error('退出登录失败:', error);\n        ElMessage({\n          type: 'error',\n          message: '退出登录失败，请重试'\n        });\n      }\n    };\n    return {\n      username,\n      userEmail,\n      userAvatar,\n      userInitial,\n      avatarColor,\n      shouldShowUsername,\n      goToProfile,\n      goToSettings,\n      handleLogout\n    };\n  }\n};","map":{"version":3,"names":["computed","ref","useStore","useRouter","User","Setting","SwitchButton","ArrowDown","ElMessage","name","components","props","showUsername","type","Boolean","default","setup","store","router","getRandomColor","hue","Math","floor","random","avatarColor","username","state","auth","user","userEmail","email","userAvatar","avatar","userInitial","value","charAt","toUpperCase","shouldShowUsername","goToProfile","push","goToSettings","handleLogout","dispatch","message","error","console"],"sources":["E:\\code\\PersonalBolg1\\frontend\\src\\components\\UserDropdown.vue"],"sourcesContent":["<template>\r\n  <el-dropdown class=\"user-dropdown\" trigger=\"click\">\r\n    <div class=\"user-info\">\r\n      <el-avatar \r\n        :size=\"40\" \r\n        :src=\"userAvatar\" \r\n        :style=\"{ backgroundColor: avatarColor }\"\r\n      >\r\n        {{ userInitial }}\r\n      </el-avatar>\r\n      <span v-if=\"shouldShowUsername\" class=\"username\">{{ username }}</span>\r\n      <el-icon class=\"el-icon--right\"><arrow-down /></el-icon>\r\n    </div>\r\n    \r\n    <template #dropdown>\r\n      <el-dropdown-menu>\r\n        <div class=\"dropdown-user-info\">\r\n          <strong>{{ username }}</strong>\r\n          <small>{{ userEmail }}</small>\r\n        </div>\r\n        <el-dropdown-item @click=\"goToProfile\">\r\n          <el-icon><User /></el-icon>\r\n          个人中心\r\n        </el-dropdown-item>\r\n        <el-dropdown-item @click=\"goToSettings\">\r\n          <el-icon><Setting /></el-icon>\r\n          设置\r\n        </el-dropdown-item>\r\n        <el-dropdown-item divided @click=\"handleLogout\">\r\n          <el-icon><SwitchButton /></el-icon>\r\n          退出登录\r\n        </el-dropdown-item>\r\n      </el-dropdown-menu>\r\n    </template>\r\n  </el-dropdown>\r\n</template>\r\n\r\n<script>\r\nimport { computed, ref } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { useRouter } from 'vue-router'\r\nimport { User, Setting, SwitchButton, ArrowDown } from '@element-plus/icons-vue'\r\nimport { ElMessage } from 'element-plus'\r\n\r\nexport default {\r\n  name: 'UserDropdown',\r\n  components: {\r\n    User,\r\n    Setting,\r\n    SwitchButton,\r\n    ArrowDown\r\n  },\r\n  props: {\r\n    showUsername: {\r\n      type: Boolean,\r\n      default: true\r\n    }\r\n  },\r\n  setup(props) {\r\n    const store = useStore()\r\n    const router = useRouter()\r\n    \r\n    // 生成随机颜色\r\n    const getRandomColor = () => {\r\n      const hue = Math.floor(Math.random() * 360)\r\n      return `hsl(${hue}, 70%, 75%)`\r\n    }\r\n    \r\n    const avatarColor = ref(getRandomColor())\r\n\r\n    // 用户信息\r\n    const username = computed(() => store.state.auth.user?.username || '用户')\r\n    const userEmail = computed(() => store.state.auth.user?.email || '')\r\n    const userAvatar = computed(() => store.state.auth.user?.avatar || '')\r\n    const userInitial = computed(() => username.value.charAt(0).toUpperCase())\r\n    \r\n    // 显示用户名（根据props控制）\r\n    const shouldShowUsername = computed(() => props.showUsername)\r\n\r\n    // 导航方法\r\n    const goToProfile = () => {\r\n      router.push('/profile')\r\n    }\r\n\r\n    const goToSettings = () => {\r\n      router.push('/settings')\r\n    }\r\n\r\n    // 退出登录\r\n    const handleLogout = async () => {\r\n      try {\r\n        await store.dispatch('auth/logout')\r\n        ElMessage({\r\n          type: 'success',\r\n          message: '已成功退出登录'\r\n        })\r\n        router.push('/login')\r\n      } catch (error) {\r\n        console.error('退出登录失败:', error)\r\n        ElMessage({\r\n          type: 'error',\r\n          message: '退出登录失败，请重试'\r\n        })\r\n      }\r\n    }\r\n\r\n    return {\r\n      username,\r\n      userEmail,\r\n      userAvatar,\r\n      userInitial,\r\n      avatarColor,\r\n      shouldShowUsername,\r\n      goToProfile,\r\n      goToSettings,\r\n      handleLogout\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.user-dropdown {\r\n  cursor: pointer;\r\n}\r\n\r\n.user-info {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  padding: 4px 8px;\r\n  border-radius: 20px;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\n.user-info:hover {\r\n  background-color: rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.username {\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  color: var(--text-color);\r\n  max-width: 120px;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n}\r\n\r\n.dropdown-user-info {\r\n  padding: 10px 16px;\r\n  border-bottom: 1px solid var(--border-color-light);\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 4px;\r\n}\r\n\r\n.dropdown-user-info strong {\r\n  font-size: 14px;\r\n  color: var(--text-color-dark);\r\n}\r\n\r\n.dropdown-user-info small {\r\n  font-size: 12px;\r\n  color: var(--text-color-light);\r\n}\r\n\r\n:deep(.el-dropdown-menu__item) {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  padding: 10px 16px;\r\n}\r\n\r\n:deep(.el-icon) {\r\n  margin-right: 4px;\r\n}\r\n</style> "],"mappings":";AAsCA,SAASA,QAAQ,EAAEC,GAAE,QAAS,KAAI;AAClC,SAASC,QAAO,QAAS,MAAK;AAC9B,SAASC,SAAQ,QAAS,YAAW;AACrC,SAASC,IAAI,EAAEC,OAAO,EAAEC,YAAY,EAAEC,SAAQ,QAAS,yBAAwB;AAC/E,SAASC,SAAQ,QAAS,cAAa;AAEvC,eAAe;EACbC,IAAI,EAAE,cAAc;EACpBC,UAAU,EAAE;IACVN,IAAI;IACJC,OAAO;IACPC,YAAY;IACZC;EACF,CAAC;EACDI,KAAK,EAAE;IACLC,YAAY,EAAE;MACZC,IAAI,EAAEC,OAAO;MACbC,OAAO,EAAE;IACX;EACF,CAAC;EACDC,KAAKA,CAACL,KAAK,EAAE;IACX,MAAMM,KAAI,GAAIf,QAAQ,CAAC;IACvB,MAAMgB,MAAK,GAAIf,SAAS,CAAC;;IAEzB;IACA,MAAMgB,cAAa,GAAIA,CAAA,KAAM;MAC3B,MAAMC,GAAE,GAAIC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,CAAC,IAAI,GAAG;MAC1C,OAAO,OAAOH,GAAG,aAAY;IAC/B;IAEA,MAAMI,WAAU,GAAIvB,GAAG,CAACkB,cAAc,CAAC,CAAC;;IAExC;IACA,MAAMM,QAAO,GAAIzB,QAAQ,CAAC,MAAMiB,KAAK,CAACS,KAAK,CAACC,IAAI,CAACC,IAAI,EAAEH,QAAO,IAAK,IAAI;IACvE,MAAMI,SAAQ,GAAI7B,QAAQ,CAAC,MAAMiB,KAAK,CAACS,KAAK,CAACC,IAAI,CAACC,IAAI,EAAEE,KAAI,IAAK,EAAE;IACnE,MAAMC,UAAS,GAAI/B,QAAQ,CAAC,MAAMiB,KAAK,CAACS,KAAK,CAACC,IAAI,CAACC,IAAI,EAAEI,MAAK,IAAK,EAAE;IACrE,MAAMC,WAAU,GAAIjC,QAAQ,CAAC,MAAMyB,QAAQ,CAACS,KAAK,CAACC,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;;IAEzE;IACA,MAAMC,kBAAiB,GAAIrC,QAAQ,CAAC,MAAMW,KAAK,CAACC,YAAY;;IAE5D;IACA,MAAM0B,WAAU,GAAIA,CAAA,KAAM;MACxBpB,MAAM,CAACqB,IAAI,CAAC,UAAU;IACxB;IAEA,MAAMC,YAAW,GAAIA,CAAA,KAAM;MACzBtB,MAAM,CAACqB,IAAI,CAAC,WAAW;IACzB;;IAEA;IACA,MAAME,YAAW,GAAI,MAAAA,CAAA,KAAY;MAC/B,IAAI;QACF,MAAMxB,KAAK,CAACyB,QAAQ,CAAC,aAAa;QAClClC,SAAS,CAAC;UACRK,IAAI,EAAE,SAAS;UACf8B,OAAO,EAAE;QACX,CAAC;QACDzB,MAAM,CAACqB,IAAI,CAAC,QAAQ;MACtB,EAAE,OAAOK,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,SAAS,EAAEA,KAAK;QAC9BpC,SAAS,CAAC;UACRK,IAAI,EAAE,OAAO;UACb8B,OAAO,EAAE;QACX,CAAC;MACH;IACF;IAEA,OAAO;MACLlB,QAAQ;MACRI,SAAS;MACTE,UAAU;MACVE,WAAW;MACXT,WAAW;MACXa,kBAAkB;MAClBC,WAAW;MACXE,YAAY;MACZC;IACF;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}