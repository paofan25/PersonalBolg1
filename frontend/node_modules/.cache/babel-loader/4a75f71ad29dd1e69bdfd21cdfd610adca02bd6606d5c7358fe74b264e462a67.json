{"ast":null,"code":"import { createStore } from 'vuex';\nimport axios from 'axios';\nimport posts from './modules/posts';\nexport default createStore({\n  state: {\n    // 认证相关\n    token: localStorage.getItem('token') || '',\n    user: JSON.parse(localStorage.getItem('user') || 'null'),\n    // 作品相关\n    works: [],\n    // 留言相关\n    messages: [],\n    // 游戏分数相关\n    scores: {},\n    // UI状态\n    loading: false,\n    error: null\n  },\n  getters: {\n    isLoggedIn: state => !!state.token,\n    authUser: state => state.user,\n    isAdmin: state => state.user && state.user.role === 'admin'\n  },\n  mutations: {\n    // 认证相关\n    SET_TOKEN(state, token) {\n      state.token = token;\n    },\n    SET_USER(state, user) {\n      state.user = user;\n    },\n    CLEAR_AUTH(state) {\n      state.token = '';\n      state.user = null;\n    },\n    // 作品相关\n    SET_WORKS(state, works) {\n      state.works = works;\n    },\n    // 留言相关\n    SET_MESSAGES(state, messages) {\n      state.messages = messages;\n    },\n    ADD_MESSAGE(state, message) {\n      state.messages.unshift(message);\n    },\n    // 游戏分数相关\n    SET_SCORES(state, {\n      game,\n      scores\n    }) {\n      state.scores[game] = scores;\n    },\n    // UI状态\n    SET_LOADING(state, status) {\n      state.loading = status;\n    },\n    SET_ERROR(state, error) {\n      state.error = error;\n    }\n  },\n  actions: {\n    // 认证相关\n    async login({\n      commit\n    }, {\n      username,\n      password\n    }) {\n      try {\n        commit('SET_LOADING', true);\n        commit('SET_ERROR', null);\n        const response = await axios.post('/api/auth/login', {\n          username,\n          password\n        });\n        const {\n          token,\n          user\n        } = response.data;\n\n        // 保存到本地存储\n        localStorage.setItem('token', token);\n        localStorage.setItem('user', JSON.stringify(user));\n\n        // 更新状态\n        commit('SET_TOKEN', token);\n        commit('SET_USER', user);\n\n        // 设置axios默认头\n        axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n        commit('SET_LOADING', false);\n        return response;\n      } catch (error) {\n        commit('SET_LOADING', false);\n        commit('SET_ERROR', error.response ? error.response.data.message : error.message);\n        throw error;\n      }\n    },\n    async register({\n      commit\n    }, userData) {\n      try {\n        commit('SET_LOADING', true);\n        commit('SET_ERROR', null);\n        const response = await axios.post('/api/auth/register', userData);\n        const {\n          token,\n          user\n        } = response.data;\n\n        // 保存到本地存储\n        localStorage.setItem('token', token);\n        localStorage.setItem('user', JSON.stringify(user));\n\n        // 更新状态\n        commit('SET_TOKEN', token);\n        commit('SET_USER', user);\n\n        // 设置axios默认头\n        axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n        commit('SET_LOADING', false);\n        return response;\n      } catch (error) {\n        commit('SET_LOADING', false);\n        commit('SET_ERROR', error.response ? error.response.data.message : error.message);\n        throw error;\n      }\n    },\n    logout({\n      commit\n    }) {\n      // 清除本地存储\n      localStorage.removeItem('token');\n      localStorage.removeItem('user');\n\n      // 清除axios默认头\n      delete axios.defaults.headers.common['Authorization'];\n\n      // 更新状态\n      commit('CLEAR_AUTH');\n    }\n  },\n  modules: {\n    posts\n  }\n});","map":{"version":3,"names":["createStore","axios","posts","state","token","localStorage","getItem","user","JSON","parse","works","messages","scores","loading","error","getters","isLoggedIn","authUser","isAdmin","role","mutations","SET_TOKEN","SET_USER","CLEAR_AUTH","SET_WORKS","SET_MESSAGES","ADD_MESSAGE","message","unshift","SET_SCORES","game","SET_LOADING","status","SET_ERROR","actions","login","commit","username","password","response","post","data","setItem","stringify","defaults","headers","common","register","userData","logout","removeItem","modules"],"sources":["E:/code/PersonalBolg1/frontend/src/store/index.js"],"sourcesContent":["import { createStore } from 'vuex'\nimport axios from 'axios'\nimport posts from './modules/posts'\n\nexport default createStore({\n  state: {\n    // 认证相关\n    token: localStorage.getItem('token') || '',\n    user: JSON.parse(localStorage.getItem('user') || 'null'),\n    \n    // 作品相关\n    works: [],\n    \n    // 留言相关\n    messages: [],\n    \n    // 游戏分数相关\n    scores: {},\n    \n    // UI状态\n    loading: false,\n    error: null\n  },\n  \n  getters: {\n    isLoggedIn: state => !!state.token,\n    authUser: state => state.user,\n    isAdmin: state => state.user && state.user.role === 'admin'\n  },\n  \n  mutations: {\n    // 认证相关\n    SET_TOKEN(state, token) {\n      state.token = token\n    },\n    SET_USER(state, user) {\n      state.user = user\n    },\n    CLEAR_AUTH(state) {\n      state.token = ''\n      state.user = null\n    },\n    \n    // 作品相关\n    SET_WORKS(state, works) {\n      state.works = works\n    },\n    \n    // 留言相关\n    SET_MESSAGES(state, messages) {\n      state.messages = messages\n    },\n    ADD_MESSAGE(state, message) {\n      state.messages.unshift(message)\n    },\n    \n    // 游戏分数相关\n    SET_SCORES(state, { game, scores }) {\n      state.scores[game] = scores\n    },\n    \n    // UI状态\n    SET_LOADING(state, status) {\n      state.loading = status\n    },\n    SET_ERROR(state, error) {\n      state.error = error\n    }\n  },\n  \n  actions: {\n    // 认证相关\n    async login({ commit }, { username, password }) {\n      try {\n        commit('SET_LOADING', true)\n        commit('SET_ERROR', null)\n        \n        const response = await axios.post('/api/auth/login', { username, password })\n        \n        const { token, user } = response.data\n        \n        // 保存到本地存储\n        localStorage.setItem('token', token)\n        localStorage.setItem('user', JSON.stringify(user))\n        \n        // 更新状态\n        commit('SET_TOKEN', token)\n        commit('SET_USER', user)\n        \n        // 设置axios默认头\n        axios.defaults.headers.common['Authorization'] = `Bearer ${token}`\n        \n        commit('SET_LOADING', false)\n        return response\n      } catch (error) {\n        commit('SET_LOADING', false)\n        commit('SET_ERROR', error.response ? error.response.data.message : error.message)\n        throw error\n      }\n    },\n    \n    async register({ commit }, userData) {\n      try {\n        commit('SET_LOADING', true)\n        commit('SET_ERROR', null)\n        \n        const response = await axios.post('/api/auth/register', userData)\n        \n        const { token, user } = response.data\n        \n        // 保存到本地存储\n        localStorage.setItem('token', token)\n        localStorage.setItem('user', JSON.stringify(user))\n        \n        // 更新状态\n        commit('SET_TOKEN', token)\n        commit('SET_USER', user)\n        \n        // 设置axios默认头\n        axios.defaults.headers.common['Authorization'] = `Bearer ${token}`\n        \n        commit('SET_LOADING', false)\n        return response\n      } catch (error) {\n        commit('SET_LOADING', false)\n        commit('SET_ERROR', error.response ? error.response.data.message : error.message)\n        throw error\n      }\n    },\n    \n    logout({ commit }) {\n      // 清除本地存储\n      localStorage.removeItem('token')\n      localStorage.removeItem('user')\n      \n      // 清除axios默认头\n      delete axios.defaults.headers.common['Authorization']\n      \n      // 更新状态\n      commit('CLEAR_AUTH')\n    }\n  },\n  \n  modules: {\n    posts\n  }\n})"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}